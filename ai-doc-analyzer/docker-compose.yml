services:
  backend:
    build: ./backend
    ports: ["8000:8000"]
    environment:
      - LOG_LEVEL=info
    healthcheck:
      test: ["CMD", "python", "-c", "import urllib.request; urllib.request.urlopen(\"http://127.0.0.1:8000/healthz\", timeout=3); print(\"ok\")"]
      interval: 10s
      timeout: 5s
      retries: 5
  ui:
    build: ./ui
    ports: ["8502:8501"]
    environment:
      - API_URL=http://backend:8000
    depends_on:
      backend:
        condition: service_healthy
